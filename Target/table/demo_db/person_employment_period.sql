/* <sc-table> DEMO_DB.PERSON_EMPLOYMENT_PERIOD </sc-table> */
CREATE TEMPORARY TABLE DEMO_DB.DEMO_DB.TEMP_QUAL_TABLE AS
(SELECT
CALENDARYEAR || '-' ||
MONTHNUMBEROFYEAR AS YEARMONTH,
CALENDARYEAR YR,
MONTHNUMBEROFYEAR AS SALE_MONTH,
SALESAMOUNT AS SALE_AMT
FROM DEMO_DB.DEMO_DB.DIMDATE DD, DEMO_DB.DEMO_DB.FACTINTERNETSALES FIS
WHERE FIS.ORDERDATEKEY = DD.DATEKEY
QUALIFY RANK() OVER (PARTITION BY YR ORDER BY SALESAMOUNT) = 1
) ;