/**** WARNING: MISSING DEPENDENT OBJECT "DEMO_DB.PERSON_EMPLOYMENT_PERIOD" ****/
/* <sc-view> DEMO_DB.PERIOD_INTERVAL_BEGIN </sc-view> */
CREATE OR REPLACE VIEW DEMO_DB.DEMO_DB.PERIOD_INTERVAL_BEGIN
AS
SELECT
PEP.PERSON_ID,
CAST(PERIOD_BEGIN_UDF(PEP.EMPLOYMENT_PERIOD) AS TIMESTAMP)    AS BEGINEMPLOYMENT,
PL.LOGIN_DTM,
TIMESTAMPDIFF('HOUR',
CAST(PERIOD_BEGIN_UDF(PEP.EMPLOYMENT_PERIOD) AS TIMESTAMP),
PL.LOGIN_DTM) AS HOURSBEFOREFIRSTLOGIN
FROM DEMO_DB.DEMO_DB.PERSON_EMPLOYMENT_PERIOD    AS PEP
JOIN DEMO_DB.DEMO_DB.PERSON_LOGIN                AS PL
ON PEP.PERSON_ID = PL.PERSON_ID
QUALIFY RANK() OVER (
PARTITION BY PL.PERSON_ID
ORDER BY PL.LOGIN_DTM
) = 1;