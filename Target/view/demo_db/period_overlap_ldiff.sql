/* <sc-view> DEMO_DB.PERIOD_OVERLAP_LDIFF </sc-view> */
CREATE OR REPLACE VIEW DEMO_DB.DEMO_DB.PERIOD_OVERLAP_LDIFF
AS
SELECT
'OVERLAP' FUNC,
FIRST_NAME,
LAST_NAME
FROM DEMO_DB.DEMO_DB.EMPLOYEE_PERIOD
WHERE DEMO_DB.PUBLIC.PERIOD_OVERLAPS_UDF( JOB_DURATION, '2009-01-01*2010-09-24')
UNION ALL
SELECT
'LDIFF' FUNC,
FIRST_NAME,
LAST_NAME
FROM DEMO_DB.DEMO_DB.EMPLOYEE_PERIOD
WHERE TIMESTAMPDIFF('MONTH', DEMO_DB.PUBLIC.PERIOD_BEGIN_UDF(DEMO_DB.PUBLIC.PERIOD_LDIFF_UDF(JOB_DURATION, '2009-01-01*2010-09-24')), DEMO_DB.PUBLIC.PERIOD_END_UDF(DEMO_DB.PUBLIC.PERIOD_LDIFF_UDF(JOB_DURATION, '2009-01-01*2010-09-24'))) > 3
UNION ALL
SELECT
'RDIFF' FUNC,
FIRST_NAME,
LAST_NAME
FROM DEMO_DB.DEMO_DB.EMPLOYEE_PERIOD
WHERE DEMO_DB.PUBLIC.PERIOD_RDIFF_UDF( JOB_DURATION, '2009-01-01*2010-09-24') IS NOT NULL;