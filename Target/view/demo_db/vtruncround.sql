/**** WARNING: MISSING DEPENDENT OBJECT "DEMO_DB.vtargetmail" ****/
/* <sc-view> DEMO_DB.vtruncround</sc-view> */
-- Trunc and round
-- With a missing dependency.
CREATE OR REPLACE VIEW DEMO_DB.DEMO_DB.vtruncround
AS
SELECT
region,
TRUNC_DATE_UDF(DATEFIRSTPURCHASE, 'MON') TRUNC_DATE,
TRUNC_DATE_UDF(DATEFIRSTPURCHASE, 'DD') TRUNC_DATE_DD,
ROUND_DATE_UDF(DATEFIRSTPURCHASE, 'RM') RND_DATE,
avg(yearlyincome) avg_annual_income,
TRUNC(AVG(YEARLYINCOME)) TRUNC_INCOME,
TRUNC(AVG(YEARLYINCOME), 2) TRNC_INCOME_2,
ROUND(AVG(TOTALCHILDREN),0) RND_AVG_CHILDREN,
avg(totalchildren) avg_children,
ROUND(AVG(AGE)) RND_AVG_AGE,
avg(age) avg_age
FROM DEMO_DB.DEMO_DB.vtargetmail
where datefirstpurchase in ('2011-02-08', '2011-02-09')
group by
region, TRUNC_DATE_UDF(DATEFIRSTPURCHASE, 'MON'), TRUNC_DATE_UDF(DATEFIRSTPURCHASE, 'DD'), ROUND_DATE_UDF(DATEFIRSTPURCHASE, 'RM');